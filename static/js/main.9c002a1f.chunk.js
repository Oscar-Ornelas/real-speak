(this["webpackJsonpreal-speak"]=this["webpackJsonpreal-speak"]||[]).push([[0],{108:function(e,t,a){"use strict";a.r(t);var n=a(0),o=a.n(n),r=a(30),c=a.n(r),s=a(1),m=a(9),l=(a(61),a(6)),i=a.n(l),u=a(16),d=a(55),f=a(51),p=a.n(f),h=function(){return window.history.replaceState({},document.title,window.location.pathname)},v=o.a.createContext(),b=function(){return Object(n.useContext)(v)};var N=function(){var e=b().loginWithRedirect;return o.a.createElement("div",{className:"landing"},o.a.createElement("h1",{className:"logo"},"RealSpeak"),o.a.createElement("h2",{className:"landing-header"},"A new way to chat with your communities and friends."),o.a.createElement("p",{className:"landing-subtitle"},"RealSpeak is the easiest way to communicate over voice, video, and text, whether you\u2019re part of a school club, a nightly gaming group, a worldwide art community, or just a handful of friends that want to hang out."),o.a.createElement("button",{className:"landing-btn",onClick:function(){return e({})}},"Sign Up"))};var E=function(e){var t=Object(n.useState)(Math.floor(9999999*Math.random()+1e6)),a=Object(s.a)(t,2),r=a[0],c=(a[1],Object(n.useState)("")),l=Object(s.a)(c,2),i=l[0],u=l[1],d=Object(n.useState)(null),f=Object(s.a)(d,2),p=f[0],h=f[1],v=Object(m.f)(),N=b().user;return Object(n.useEffect)((function(){N&&e.access_token&&fetch("https://dev-pdp1v9a4.auth0.com/api/v2/users/".concat(N.sub),{headers:{Authorization:"Bearer ".concat(e.access_token)}}).then((function(e){return e.json()})).then((function(e){h(e.username)})).catch((function(e){return console.log(e)}))}),[N,e.access_token]),Object(n.useEffect)((function(){if(N&&p){var e={userId:N.name};fetch("http://localhost:4001/api/findUser",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(e)}).then((function(e){return e.json()})).then((function(e){if(e.isNewUser){u("General");var t={roomId:r,roomName:"General",userId:N.name,username:p};fetch("http://localhost:4001/api/createUser",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(t)}).then((function(){return v.push("/chatapp/".concat(i,"/").concat(r))})).catch((function(e){return console.log(e)}))}else{var a={roomId:e.rooms[0]};fetch("http://localhost:4001/api/findRoom",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(a)}).then((function(e){return e.json()})).then((function(e){console.log(e),v.push("/chatapp/".concat(e.roomName,"/").concat(e.roomId))})).catch((function(e){return console.log(e)}))}}))}}),[N,p]),o.a.createElement("div",null)},g=a(33),O=a(54),j=a.n(O);var S=a(15),y=a(5),k=a(17),C=a.n(k);C.a.setAppElement("#root");var I=function(e){var t=Object(n.useState)({newUserID:"",userId:"",newRoomName:""}),a=Object(s.a)(t,2),r=a[0],c=a[1],l=Object(n.useState)(!1),i=Object(s.a)(l,2),u=i[0],d=i[1];function f(){d(!1)}return Object(m.f)(),o.a.createElement("div",null,o.a.createElement("button",{className:"navbar-modal-btn",onClick:function(){d(!0)}},o.a.createElement("i",{className:"fas fa-ellipsis-v"})),o.a.createElement(C.a,{isOpen:u,onRequestClose:f,contentLabel:"Room Settings",className:"modal",overlayClassName:"overlay"},o.a.createElement("div",{className:"room-form-modal"},o.a.createElement("div",{className:"room-form-modal-header"},o.a.createElement("h2",{className:"room-form-header"},"Settings"),o.a.createElement("button",{className:"close-room-form",onClick:f},"X")),o.a.createElement("div",{className:"room-form-container"},o.a.createElement("form",{className:"room-form"},o.a.createElement("div",{className:"room-form-inputs"},o.a.createElement("div",{className:"input-item"},o.a.createElement("label",{className:"room-form-label",for:"userId"},"Add user"),o.a.createElement("input",{placeholder:"User Id (Email)",className:"input",id:"userId",onChange:function(e){var t=e.target,a=t.value,n=t.name;c((function(e){return Object(y.a)({},e,Object(S.a)({},n,a))}))},value:r.userId,type:"text",name:"userId"})),o.a.createElement("button",{className:"room-form-submit",onClick:function(t){var a={userId:r.userId,roomId:e.roomId};t.preventDefault(),fetch("http://localhost:4001/api/addUserToRoom",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(a)}),d(!1),c((function(e){return Object(y.a)({},e,{newUserId:""})}))}},"Add User")))))))};var w=function(e){return o.a.createElement("header",{className:"header"},o.a.createElement("div",{className:"header-content"},o.a.createElement("div",{className:"nav-container"},o.a.createElement("div",{className:"nav-adjacent"},o.a.createElement("button",{onClick:e.toggleRoomNavSlide,className:"open-room-side-nav"},o.a.createElement("i",{className:"fas fa-bars"})),o.a.createElement("h2",{className:"room-header"},"# ",e.roomName)),o.a.createElement("nav",{className:"nav"},o.a.createElement("ul",{className:"nav-list"},o.a.createElement("li",{className:"nav-item open-user-side-nav",onClick:e.toggleUserNavSlide},o.a.createElement("i",{className:"fas fa-user-friends"})),o.a.createElement(I,{roomName:e.roomName,roomId:e.roomId}))))))},x=a(14);C.a.setAppElement("#root");var R=function(e){var t=b().user,a=Object(n.useState)(!1),r=Object(s.a)(a,2),c=r[0],m=r[1],l=Object(n.useState)({roomName:"",roomDescription:""}),i=Object(s.a)(l,2),u=i[0],d=i[1];function f(){m(!1)}function p(e){var t=e.target,a=t.value,n=t.name;d((function(e){return Object(y.a)({},e,Object(S.a)({},n,a))}))}return o.a.createElement("div",null,o.a.createElement(o.a.Fragment,null,o.a.createElement("p",{onClick:function(){m(!0)},className:"sidebar-modal-header"},"+ Add a room"),o.a.createElement(C.a,{isOpen:c,onRequestClose:f,contentLabel:"Create Room Form",className:"modal",overlayClassName:"overlay"},o.a.createElement("div",{className:"room-form-modal"},o.a.createElement("div",{className:"room-form-modal-header"},o.a.createElement("h2",{className:"room-form-header"},"Create Room"),o.a.createElement("button",{className:"close-room-form",onClick:f},"X")),o.a.createElement("div",{className:"room-form-container"},o.a.createElement("form",{className:"room-form"},o.a.createElement("div",{className:"room-form-inputs"},o.a.createElement("div",{className:"input-item"},o.a.createElement("label",{className:"room-form-label",for:"roomName"},"Name"),o.a.createElement("input",{maxlength:"25",className:"input",id:"roomName",onChange:p,value:u.roomName,required:!0,type:"text",name:"roomName"})),o.a.createElement("div",{className:"input-item"},o.a.createElement("label",{className:"room-form-label",for:"roomDescription"},"Description (Optional)"),o.a.createElement("input",{maxLength:"75",className:"input",id:"roomDescription",onChange:p,value:u.roomDescription,type:"text",name:"roomDescription"}))),o.a.createElement("button",{className:"room-form-submit",onClick:function(a){var n=Math.floor(9999999*Math.random()+1e6),o=u.roomName,r={userId:t.name,roomId:n,roomName:o,username:e.username};a.preventDefault(),fetch("http://localhost:4001/api/updateUser",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(r)}),m(!1),setTimeout((function(){window.location.reload()}),100)}},"Create Room")))))))};var T=function(e){var t=b(),a=t.isAuthenticated,r=t.loginWithRedirect,c=t.logout,s=t.user;function m(){setTimeout((function(){window.location.reload()}),10)}return Object(n.useEffect)((function(){function t(){e.setRoomNavSlide(!1)}return document.body.addEventListener("click",t),function(){return document.body.removeEventListener("click",t)}}),[]),o.a.createElement("div",{className:"room-side-bar"},o.a.createElement("div",{className:"room-side-bar-content"},o.a.createElement("nav",{className:"room-side-nav ".concat(e.roomNavSlide?"room-side-nav-open":"")},o.a.createElement("div",{className:"room-side-nav-content"},o.a.createElement("h3",{className:"room-side-nav-list-header"},"Rooms"),o.a.createElement("ul",{className:"room-side-nav-list"},e.rooms.map((function(e){return o.a.createElement("li",{key:e.roomId,onClick:m,className:"room-side-nav-item"},o.a.createElement(x.a,{className:"link",to:"/chatapp/".concat(e.roomName,"/").concat(e.roomId)},"# ",e.roomName))})),s&&o.a.createElement(R,{username:e.username}))),!a&&o.a.createElement("button",{onClick:function(){return r({})}},"Log in"),a&&o.a.createElement("button",{className:"logout-btn",onClick:function(){return c()}},"Log out"))))};var U=function(e){return Object(n.useEffect)((function(){function t(){e.setUserNavSlide(!1)}return document.body.addEventListener("click",t),function(){return document.body.removeEventListener("click",t)}}),[]),o.a.createElement("div",{className:"user-side-bar"},o.a.createElement("div",{className:"user-side-bar-content"},o.a.createElement("nav",{className:"user-side-nav ".concat(e.userNavSlide?"user-side-nav-open":"")},o.a.createElement("div",{className:"user-side-nav-content"},o.a.createElement("h3",{className:"user-side-nav-list-header"},"# ",e.roomName),o.a.createElement("p",{className:"user-side-nav-room-description"},e.roomDescription),o.a.createElement("h3",{className:"user-side-nav-list-header"},"Members"),o.a.createElement("ul",{className:"user-side-nav-list"},e.roomUsers.map((function(e){return o.a.createElement("li",{key:e.id,className:"user-side-nav-item"}," ",e.username)})))))))};var P=function(e){return o.a.createElement("ul",{className:"message-list"},0===e.messages.length&&o.a.createElement("li",{className:"message-welcome"},o.a.createElement("h2",{className:"room-header"},"# ",e.roomName),o.a.createElement("p",null,"Welcome to the ",o.a.createElement("strong",null,"# ",e.roomName)," room!")),e.messages.map((function(e,t){return o.a.createElement("li",{className:"message-item",key:t},o.a.createElement("div",{className:"message-item-content"},o.a.createElement("h3",{className:"message-sender"},e.username),o.a.createElement("p",{className:"message-text"},e.text)))})),o.a.createElement("li",null))};var A=function(e){var t=Object(n.useState)({username:"",timeSent:"",text:"",roomId:""}),a=Object(s.a)(t,2),r=a[0],c=a[1];return Object(n.useEffect)((function(){e.username&&c((function(t){return Object(y.a)({},t,{username:e.username})})),e.roomId&&c((function(t){return Object(y.a)({},t,{roomId:e.roomId})}))}),[e.username,e.roomId]),o.a.createElement("div",{className:"form-container"},o.a.createElement("div",{className:"form-content"},o.a.createElement("form",{onSubmit:function(t){t.preventDefault(),e.onSubmit(r),c((function(e){return Object(y.a)({},e,{timeSent:"",text:""})}))},className:"input-field"},o.a.createElement("input",{type:"text",className:"message-input",onChange:function(e){var t=e.target.value;c((function(e){return Object(y.a)({},e,{text:t})}))},value:r.text,placeholder:"Message #".concat(e.roomName)}),o.a.createElement("button",{className:"message-submit"},o.a.createElement("i",{className:"fas fa-paper-plane"})))))};var D=function(e){var t=Object(n.useState)({}),a=Object(s.a)(t,2),r=a[0],c=a[1],l=Object(n.useState)([]),i=Object(s.a)(l,2),u=i[0],d=i[1],f=Object(n.useState)([]),p=Object(s.a)(f,2),h=p[0],v=p[1],N=Object(n.useState)([]),E=Object(s.a)(N,2),O=E[0],S=E[1],y=Object(n.useState)(!1),k=Object(s.a)(y,2),C=k[0],I=k[1],x=Object(n.useState)(!1),R=Object(s.a)(x,2),D=R[0],_=R[1],J=Object(m.g)().roomId,W=Object(m.g)().roomName,L=b().user,M=j()("http://127.0.0.1:4001");return Object(n.useEffect)((function(){var e={roomId:J};fetch("http://localhost:4001/api/findRoom",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(e)}).then((function(e){return e.json()})).then((function(e){console.log(e.users),v(e.users)}))}),[]),Object(n.useEffect)((function(){var e={userId:L.name};fetch("http://localhost:4001/api/findUser",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(e)}).then((function(e){return e.json()})).then((function(e){e.rooms.forEach((function(e){var t={roomId:e};fetch("http://localhost:4001/api/findRoom",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(t)}).then((function(e){return e.json()})).then((function(e){return d((function(t){return[].concat(Object(g.a)(t),[e])}))}))}))}))}),[]),Object(n.useEffect)((function(){M.on("connected",(function(e){console.log(e)})),M.emit("joined_room",J),M.on("message",(function(e){console.log(e),S((function(t){return[].concat(Object(g.a)(t),[e])}))}))}),[J]),Object(n.useEffect)((function(){L&&e.access_token&&(console.log(L),fetch("https://dev-pdp1v9a4.auth0.com/api/v2/users/".concat(L.sub),{headers:{Authorization:"Bearer ".concat(e.access_token)}}).then((function(e){return e.json()})).then((function(e){c(e)})).catch((function(e){return console.log(e)})))}),[L,e.access_token]),Object(n.useEffect)((function(){O.length>0&&window.scrollTo(0,document.body.scrollHeight)}),[O]),o.a.createElement("div",null,o.a.createElement("div",{className:"chat-box"},o.a.createElement(T,{setRoomNavSlide:I,roomNavSlide:C,username:r.username,rooms:u}),o.a.createElement("main",{className:"main"},o.a.createElement(w,{roomId:J,toggleUserNavSlide:function(){_((function(e){return!e}))},toggleRoomNavSlide:function(){I((function(e){return!e}))},roomName:W}),o.a.createElement(P,{messages:O,roomName:W}),o.a.createElement(A,{roomId:J,username:r.username,roomName:W,onSubmit:function(e){M.emit("sent_message",e)},className:"input-field"})),o.a.createElement(U,{roomName:W,rooms:u,roomDescription:"asdasd",roomUsers:h,userNavSlide:D,setUserNavSlide:_})))},_=a(3),J=Object(_.a)();var W=function(){var e=Object(n.useState)(null),t=Object(s.a)(e,2),a=t[0],r=t[1],c=b(),l=(c.loading,c.user),i=c.isAuthenticated;return c.loginWithRedirect,Object(n.useEffect)((function(){fetch("http://localhost:4001/api/getAccessToken").then((function(e){return e.json()})).then((function(e){console.log(e),r(e.access_token)})).catch((function(e){return console.log(e)}))}),[]),o.a.createElement("div",{className:"app"},o.a.createElement(m.b,{basename:"/real-speak",history:J},o.a.createElement(m.c,null,o.a.createElement(m.a,{path:"/",exact:!0},i?o.a.createElement(E,{access_token:a}):o.a.createElement(N,null)),o.a.createElement(m.a,{path:"/chatapp/:roomName/:roomId"},l&&o.a.createElement(D,{access_token:a})))))},L=a(20);c.a.render(o.a.createElement((function(e){var t=e.children,a=e.onRedirectCallback,r=void 0===a?h:a,c=Object(d.a)(e,["children","onRedirectCallback"]),m=Object(n.useState)(),l=Object(s.a)(m,2),f=l[0],b=l[1],N=Object(n.useState)(),E=Object(s.a)(N,2),g=E[0],O=E[1],j=Object(n.useState)(),S=Object(s.a)(j,2),y=S[0],k=S[1],C=Object(n.useState)(!0),I=Object(s.a)(C,2),w=I[0],x=I[1],R=Object(n.useState)(!1),T=Object(s.a)(R,2),U=T[0],P=T[1];Object(n.useEffect)((function(){(function(){var e=Object(u.a)(i.a.mark((function e(){var t,a,n,o,s;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,p()(c);case 2:if(t=e.sent,k(t),!window.location.search.includes("code=")||!window.location.search.includes("state=")){e.next=10;break}return e.next=7,t.handleRedirectCallback();case 7:a=e.sent,n=a.appState,r(n);case 10:return e.next=12,t.isAuthenticated();case 12:if(o=e.sent,b(o),!o){e.next=19;break}return e.next=17,t.getUser();case 17:s=e.sent,O(s);case 19:x(!1);case 20:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}})()()}),[]);var A=function(){var e=Object(u.a)(i.a.mark((function e(){var t,a,n=arguments;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=n.length>0&&void 0!==n[0]?n[0]:{},P(!0),e.prev=2,e.next=5,y.loginWithPopup(t);case 5:e.next=10;break;case 7:e.prev=7,e.t0=e.catch(2),console.error(e.t0);case 10:return e.prev=10,P(!1),e.finish(10);case 13:return e.next=15,y.getUser();case 15:a=e.sent,O(a),b(!0);case 18:case"end":return e.stop()}}),e,null,[[2,7,10,13]])})));return function(){return e.apply(this,arguments)}}(),D=function(){var e=Object(u.a)(i.a.mark((function e(){var t;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return x(!0),e.next=3,y.handleRedirectCallback();case 3:return e.next=5,y.getUser();case 5:t=e.sent,x(!1),b(!0),O(t);case 9:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();return o.a.createElement(v.Provider,{value:{isAuthenticated:f,user:g,loading:w,popupOpen:U,loginWithPopup:A,handleRedirectCallback:D,getIdTokenClaims:function(){return y.getIdTokenClaims.apply(y,arguments)},loginWithRedirect:function(){return y.loginWithRedirect.apply(y,arguments)},getTokenSilently:function(){return y.getTokenSilently.apply(y,arguments)},getTokenWithPopup:function(){return y.getTokenWithPopup.apply(y,arguments)},logout:function(){return y.logout.apply(y,arguments)}}},t)}),{domain:L.domain,client_id:L.clientId,redirect_uri:window.location.origin,audience:L.audience,onRedirectCallback:function(e){J.push(e&&e.targetUrl?e.targetUrl:window.location.pathname)}},o.a.createElement(W,null)),document.getElementById("root"))},20:function(e){e.exports=JSON.parse('{"domain":"dev-pdp1v9a4.auth0.com","clientId":"iu4i9gEVNZSkkHr3pb43fh3voHFzYPDd"}')},56:function(e,t,a){e.exports=a(108)},61:function(e,t,a){},96:function(e,t){}},[[56,1,2]]]);
//# sourceMappingURL=main.9c002a1f.chunk.js.map