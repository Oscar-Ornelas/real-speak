{"version":3,"sources":["../node_modules/keyv/src sync","../node_modules/got/source sync","components/MessageList.js","components/Input.js","react-auth0-spa.js","components/ChatApp.js","components/ChatMessage.js","components/Home.js","views/ExternalApi.js","components/Profile.js","utils/history.js","App.js","index.js"],"names":["webpackEmptyContext","req","e","Error","code","keys","resolve","module","exports","id","MessageList","props","className","messages","map","message","index","key","sender","name","text","Input","useState","setMessage","onSubmit","preventDefault","onChange","value","target","placeholder","roomName","DEFAULT_REDIRECT_CALLBACK","window","history","replaceState","document","title","location","pathname","Auth0Context","React","createContext","useAuth0","useContext","ChatApp","currentUser","setCurrentUser","users","currentRoom","setCurrentRoom","setMessages","setUsers","loading","useEffect","ChatManager","instanceLocator","process","userId","currentId","tokenProvider","TokenProvider","url","connect","then","subscribeToRoom","roomId","messageLimit","hooks","onMessage","prevMessages","userIds","scrollTo","body","scrollHeight","catch","error","console","log","length","undefined","sendMessage","ChatMessage","isAuthenticated","loginWithRedirect","logout","onClick","to","chatkit","Chatkit","Home","useHistory","isChatkitUser","setIsChatkitUser","chatkitUser","setChatkitUser","user","fullUser","setFullUser","fetch","sub","headers","Authorization","response","json","data","email","custom_data","err","createUser","username","ExternalApi","showResult","setShowResult","apiMessage","setApiMessage","callApi","getTokenSilently","a","responseData","JSON","stringify","Profile","src","picture","alt","createBrowserHistory","App","browserHistory","path","exact","component","ReactDOM","render","children","onRedirectCallback","initOptions","setIsAuthenticated","setUser","auth0Client","setAuth0","setLoading","popupOpen","setPopupOpen","createAuth0Client","auth0FromHook","search","includes","handleRedirectCallback","appState","getUser","initAuth0","loginWithPopup","params","Provider","getIdTokenClaims","getTokenWithPopup","domain","config","client_id","clientId","redirect_uri","origin","audience","push","targetUrl","getElementById"],"mappings":"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","file":"static/js/main.caba339a.chunk.js","sourcesContent":["function webpackEmptyContext(req) {\n\tvar e = new Error(\"Cannot find module '\" + req + \"'\");\n\te.code = 'MODULE_NOT_FOUND';\n\tthrow e;\n}\nwebpackEmptyContext.keys = function() { return []; };\nwebpackEmptyContext.resolve = webpackEmptyContext;\nmodule.exports = webpackEmptyContext;\nwebpackEmptyContext.id = 291;","function webpackEmptyContext(req) {\n\tvar e = new Error(\"Cannot find module '\" + req + \"'\");\n\te.code = 'MODULE_NOT_FOUND';\n\tthrow e;\n}\nwebpackEmptyContext.keys = function() { return []; };\nwebpackEmptyContext.resolve = webpackEmptyContext;\nmodule.exports = webpackEmptyContext;\nwebpackEmptyContext.id = 299;","import React from 'react';\r\n\r\nfunction MessageList(props) {\r\n  return (\r\n    <ul className=\"message-list\">\r\n        {props.messages.map((message, index) => (\r\n            <li className=\"message-item\" key={index}>\r\n              <div className=\"message-item-content\">\r\n                <h3 className=\"message-sender\">{message.sender.name}</h3>\r\n                <p className=\"message-text\">{message.text}</p>\r\n              </div>\r\n            </li>\r\n        ))}\r\n        <li></li>\r\n    </ul>\r\n  )\r\n}\r\n\r\nexport default MessageList;\r\n","import React, {useState} from 'react';\r\n\r\nfunction Input(props) {\r\n  const [message, setMessage] = useState(\"\");\r\n\r\n  function handleChange(e) {\r\n    const {value} = e.target;\r\n    setMessage(value);\r\n  }\r\n\r\n  function handleSubmit(e) {\r\n    e.preventDefault();\r\n    props.onSubmit(message);\r\n    setMessage(\"\");\r\n  }\r\n\r\n  return (\r\n    <div className=\"form-container\">\r\n      <form onSubmit={handleSubmit} className=\"input-field\">\r\n          <textarea className=\"message-input\" onChange={handleChange} value={message} placeholder={`Message #${props.roomName}`} />\r\n          <button className=\"message-submit\"><i className=\"fas fa-paper-plane\"></i></button>\r\n      </form>\r\n    </div>\r\n\r\n  )\r\n\r\n}\r\nexport default Input;\r\n","import React, { useState, useEffect, useContext } from \"react\";\r\nimport createAuth0Client from \"@auth0/auth0-spa-js\";\r\n\r\nconst DEFAULT_REDIRECT_CALLBACK = () =>\r\n  window.history.replaceState({}, document.title, window.location.pathname);\r\n\r\nexport const Auth0Context = React.createContext();\r\nexport const useAuth0 = () => useContext(Auth0Context);\r\nexport const Auth0Provider = ({\r\n  children,\r\n  onRedirectCallback = DEFAULT_REDIRECT_CALLBACK,\r\n  ...initOptions\r\n}) => {\r\n  const [isAuthenticated, setIsAuthenticated] = useState();\r\n  const [user, setUser] = useState();\r\n  const [auth0Client, setAuth0] = useState();\r\n  const [loading, setLoading] = useState(true);\r\n  const [popupOpen, setPopupOpen] = useState(false);\r\n\r\n  useEffect(() => {\r\n    const initAuth0 = async () => {\r\n      const auth0FromHook = await createAuth0Client(initOptions);\r\n      setAuth0(auth0FromHook);\r\n\r\n      if (window.location.search.includes(\"code=\") &&\r\n          window.location.search.includes(\"state=\")) {\r\n        const { appState } = await auth0FromHook.handleRedirectCallback();\r\n        onRedirectCallback(appState);\r\n      }\r\n\r\n      const isAuthenticated = await auth0FromHook.isAuthenticated();\r\n\r\n      setIsAuthenticated(isAuthenticated);\r\n\r\n      if (isAuthenticated) {\r\n        const user = await auth0FromHook.getUser();\r\n        setUser(user);\r\n      }\r\n\r\n      setLoading(false);\r\n    };\r\n    initAuth0();\r\n    // eslint-disable-next-line\r\n  }, []);\r\n\r\n  const loginWithPopup = async (params = {}) => {\r\n    setPopupOpen(true);\r\n    try {\r\n      await auth0Client.loginWithPopup(params);\r\n    } catch (error) {\r\n      console.error(error);\r\n    } finally {\r\n      setPopupOpen(false);\r\n    }\r\n    const user = await auth0Client.getUser();\r\n    setUser(user);\r\n    setIsAuthenticated(true);\r\n  };\r\n\r\n  const handleRedirectCallback = async () => {\r\n    setLoading(true);\r\n    await auth0Client.handleRedirectCallback();\r\n    const user = await auth0Client.getUser();\r\n    setLoading(false);\r\n    setIsAuthenticated(true);\r\n    setUser(user);\r\n  };\r\n  return (\r\n    <Auth0Context.Provider\r\n      value={{\r\n        isAuthenticated,\r\n        user,\r\n        loading,\r\n        popupOpen,\r\n        loginWithPopup,\r\n        handleRedirectCallback,\r\n        getIdTokenClaims: (...p) => auth0Client.getIdTokenClaims(...p),\r\n        loginWithRedirect: (...p) => auth0Client.loginWithRedirect(...p),\r\n        getTokenSilently: (...p) => auth0Client.getTokenSilently(...p),\r\n        getTokenWithPopup: (...p) => auth0Client.getTokenWithPopup(...p),\r\n        logout: (...p) => auth0Client.logout(...p)\r\n      }}\r\n    >\r\n      {children}\r\n    </Auth0Context.Provider>\r\n  );\r\n};\r\n","import React, {useState, useEffect} from 'react';\r\nimport {ChatManager, TokenProvider} from '@pusher/chatkit-client';\r\nimport MessageList from './MessageList';\r\nimport Input from './Input';\r\nimport useApiCall from '../views/useApiCall';\r\nimport {useAuth0} from \"../react-auth0-spa\";\r\n\r\nfunction ChatApp(props) {\r\n  const [currentUser, setCurrentUser] = useState(null);\r\n  const [currentRoom, setCurrentRoom] = useState({users: []});\r\n  const [messages, setMessages] = useState([]);\r\n  const [users, setUsers] = useState([]);\r\n  const {loading} = useAuth0();\r\n\r\n  useEffect(() => {\r\n    const chatManager = new ChatManager({\r\n        instanceLocator: process.env.REACT_APP_CHATKIT_INSTANCE_LOCATOR_KEY,\r\n        userId: props.currentId,\r\n        tokenProvider: new TokenProvider({\r\n            url: process.env.REACT_APP_TEST_TOKEN\r\n        })\r\n    })\r\n\r\n    chatManager\r\n      .connect()\r\n      .then(currentUser => {\r\n          setCurrentUser(currentUser);\r\n          return currentUser.subscribeToRoom({\r\n              roomId: \"cc2ababd-754e-4cd3-a008-3082892d39eb\",\r\n              messageLimit: 100,\r\n              hooks: {\r\n                  onMessage: message => {\r\n                      setMessages(prevMessages => [...prevMessages, message])\r\n                  },\r\n              }\r\n          })\r\n      })\r\n      .then(currentRoom => {\r\n          setCurrentRoom(currentRoom);\r\n          setUsers(currentRoom.userIds);\r\n          window.scrollTo(0,document.body.scrollHeight)\r\n      })\r\n      .catch(error => console.log(error))\r\n  }, [])\r\n\r\n  useEffect(() => {\r\n    if(messages.length > 0) {\r\n      window.scrollTo(0,document.body.scrollHeight)\r\n    }\r\n  }, [messages])\r\n\r\n  function addMessage(text) {\r\n    currentUser.sendMessage({\r\n      text,\r\n      roomId: currentRoom.id\r\n    })\r\n    .catch(error => console.error('error', error));\r\n  }\r\n\r\n  return (\r\n\r\n      <div className=\"chat-box\">\r\n      {!(currentRoom.name === undefined) && (\r\n        <>\r\n          <h2 className=\"room-header\">#{currentRoom.name}</h2>\r\n          <MessageList messages={messages} />\r\n          <Input roomName={currentRoom.name} className=\"input-field\" onSubmit={addMessage} />\r\n        </>\r\n      ) }\r\n      </div>\r\n  )\r\n}\r\n\r\nexport default ChatApp;\r\n","import React from 'react';\r\nimport {Link} from 'react-router-dom';\r\nimport ChatApp from './ChatApp';\r\nimport { useAuth0 } from \"../react-auth0-spa\";\r\n\r\nfunction ChatMessage() {\r\n  const { isAuthenticated, loginWithRedirect, logout } = useAuth0();\r\n\r\n  return (\r\n    <div>\r\n      {!isAuthenticated && (\r\n        <button onClick={() => loginWithRedirect({})}>Log in</button>\r\n      )}\r\n\r\n      {isAuthenticated && <button onClick={() => logout()}>Log out</button>}\r\n\r\n      {isAuthenticated && (\r\n        <span>\r\n          <Link className=\"link\" to=\"/\">Home</Link>&nbsp;\r\n          <Link className=\"link\" to=\"/chatapp\">Chat App</Link>\r\n        </span>\r\n      )}\r\n\r\n    </div>\r\n  )\r\n\r\n}\r\n\r\nexport default ChatMessage;\r\n","import React, {useState, useEffect} from 'react';\r\nimport {useHistory} from 'react-router-dom';\r\n\r\nimport { default as Chatkit } from '@pusher/chatkit-server';\r\nimport { useAuth0 } from \"../react-auth0-spa\";\r\n\r\nconst chatkit = new Chatkit({\r\n  instanceLocator: process.env.REACT_APP_CHATKIT_INSTANCE_LOCATOR_KEY,\r\n  key: process.env.REACT_APP_CHATKIT_SECRET_KEY\r\n})\r\n\r\nfunction Home() {\r\n  const token = process.env.REACT_APP_MGMT_API_ACCESS_TOKEN;\r\n  const INSTANCE_ID = process.env.REACT_APP_CHATKIT_INSTANCE_ID;\r\n  const history = useHistory();\r\n  const [isChatkitUser, setIsChatkitUser] = useState(false);\r\n  const [chatkitUser, setChatkitUser] = useState({});\r\n  const { loading, user } = useAuth0();\r\n  const [fullUser, setFullUser] = useState({});\r\n\r\n  useEffect(() => {\r\n    if(user) {\r\n      fetch(`https://realspeak.auth0.com/api/v2/users/${user.sub}`, {\r\n        headers: {\r\n          Authorization: `Bearer ${token}`\r\n        }\r\n      })\r\n      .then(response => response.json())\r\n      .then(data => setFullUser(data))\r\n    }\r\n  }, [user])\r\n\r\n  useEffect(() => {\r\n    if(user) {\r\n      fetch(`https://us1.pusherplatform.io/services/chatkit/v7/${INSTANCE_ID}/users/${user.email}`)\r\n      .then(response => response.json())\r\n      .then(data => {\r\n        setChatkitUser(data);\r\n        setIsChatkitUser(chatkitUser.custom_data.email === user.email);\r\n      })\r\n      .catch(err => setIsChatkitUser(false))\r\n\r\n      if(!isChatkitUser) {\r\n        chatkit.createUser({\r\n          id: user.email,\r\n          name: fullUser.username\r\n        })\r\n      }\r\n\r\n    }\r\n  }, [fullUser])\r\n\r\n  console.log(fullUser);\r\n\r\n  return null;\r\n\r\n}\r\n\r\nexport default Home;\r\n","import React, { useState } from \"react\";\r\nimport { useAuth0 } from \"../react-auth0-spa\";\r\n\r\nconst ExternalApi = () => {\r\n  const [showResult, setShowResult] = useState(false);\r\n  const [apiMessage, setApiMessage] = useState(\"\");\r\n  const {user} = useAuth0();\r\n  const { getTokenSilently } = useAuth0();\r\n  const token = process.env.REACT_APP_MGMT_API_ACCESS_TOKEN;\r\n\r\n  const callApi = async () => {\r\n    try {\r\n\r\n      const response = await fetch(`https://realspeak.auth0.com/api/v2/users/${user.sub}`, {\r\n        headers: {\r\n          Authorization: `Bearer ${token}`\r\n        }\r\n      });\r\n\r\n      const responseData = await response.json();\r\n\r\n      setShowResult(true);\r\n      setApiMessage(responseData);\r\n    } catch (error) {\r\n      console.error(error);\r\n    }\r\n  };\r\n\r\n  return (\r\n    <>\r\n      <h1>External API</h1>\r\n      <button onClick={callApi}>Ping API</button>\r\n      {showResult && <code>{JSON.stringify(apiMessage, null, 2)}</code>}\r\n    </>\r\n  );\r\n};\r\n\r\nexport default ExternalApi;\r\n","import React, { Fragment } from \"react\";\r\nimport { useAuth0 } from \"../react-auth0-spa\";\r\n\r\nconst Profile = () => {\r\n  const { loading, user } = useAuth0();\r\n\r\n  if (loading || !user) {\r\n    return <div>Loading...</div>;\r\n  }\r\n\r\n  return (\r\n    <Fragment>\r\n      <img src={user.picture} alt=\"Profile\" />\r\n\r\n      <h2>{user.name}</h2>\r\n      <p>{user.email}</p>\r\n      <p>{user.username}</p>\r\n      <code>{JSON.stringify(user, null, 2)}</code>\r\n    </Fragment>\r\n  );\r\n};\r\n\r\nexport default Profile;\r\n","import { createBrowserHistory } from \"history\";\r\nexport default createBrowserHistory();\r\n","import React, {useState} from 'react';\nimport {Switch, Route, Router, useHistory} from 'react-router-dom';\nimport './App.css';\nimport ChatMessage from './components/ChatMessage';\nimport Home from './components/Home';\nimport ExternalApi from './views/ExternalApi';\nimport ChatApp from './components/ChatApp';\nimport Profile from \"./components/Profile\";\nimport browserHistory from \"./utils/history\";\n\nimport { default as Chatkit } from '@pusher/chatkit-server';\nimport { useAuth0 } from \"./react-auth0-spa\";\n\nfunction App() {\n  const { loading, user } = useAuth0();\n\n  return (\n    <div className=\"App\">\n      <Router history={browserHistory}>\n        <header>\n          <ChatMessage/>\n        </header>\n        <Switch>\n          <Route path=\"/\" exact>\n            <Home/>\n          </Route>\n          <Route path=\"/profile\" component={Profile} />\n          <Route path=\"/chatapp\">\n            <ChatApp currentId={user ? user.name : \"\"}/>\n          </Route>\n          <Route path=\"/external-api\">\n            <ExternalApi/>\n          </Route>\n        </Switch>\n      </Router>\n    </div>\n  );\n}\n\nexport default App;\n","import React from \"react\";\nimport ReactDOM from \"react-dom\";\nimport App from \"./App\";\nimport { Auth0Provider } from \"./react-auth0-spa\";\nimport config from \"./auth_config.json\";\nimport history from \"./utils/history\";\n\n// A function that routes the user to the right place\n// after login\nconst onRedirectCallback = appState => {\n  history.push(\n    appState && appState.targetUrl\n      ? appState.targetUrl\n      : window.location.pathname\n  );\n};\n\nReactDOM.render(\n  <Auth0Provider\n    domain={config.domain}\n    client_id={config.clientId}\n    redirect_uri={window.location.origin}\n    audience={config.audience}\n    onRedirectCallback={onRedirectCallback}\n  >\n    <App />\n  </Auth0Provider>,\n  document.getElementById(\"root\")\n);\n"],"sourceRoot":""}